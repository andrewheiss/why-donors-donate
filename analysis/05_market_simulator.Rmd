---
title: "Why Donors Donate?"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: scroll
runtime: shiny
---

```{r packages, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(flexdashboard)
library(plotly)
library(shiny)
library(here)
```

```{r load data}

# Beta's of everything. The only model we care about right now
public_political_social_charity_demo <- readRDS(here('analysis', 'output', 'posterior_draws', 'public_political_social_charity_demo.rds')) %>% 
  group_by(i, j) %>% 
  summarize(gamma_mean = mean(Gamma)) %>% 
  ungroup() %>% 
  pivot_wider(names_from = j, values_from = gamma_mean) %>% 
  select(-i) %>% 
  t()

# Persona Data from Market Simulator Workbook
persona_data <- readxl::read_xlsx(here('analysis', 'output', "persona_configV06.xlsx"))


#Levels (This is a guess):            Means:
#   1. Amnesty International          0.805
#   2. Greenpeace                     0.923
#   3. Oxfam                          0.620
#   4. Red Cross                      1.820
#   5. Environment                   -0.444
#   6. Human Rights                  -0.164
#   7. Refugee Relief                -0.582
#   8. Financially Transparent        1.080
#   9. Accountable                    1.130
#   10. Small wealthy donors         -0.376
#   11. Government Grants            -0.252
#   12. Criticized by Government       -0.663
#   13. Under Government Crackdown   -1.011


################### Org Reactive Element####################################

beta <- as.data.frame(matrix(rep(0), nrow = 13))

beta$levels = c("Amnesty International",
                "Greenpeace", 
                "Oxfam", 
                "Red Cross",
                # Org Issue
                "Environment", 
                "Human rights",
                "Refugee relief",
                # Transparency
                "Engages in transparency",
                # Financial Accountability
                "Engages in financial accountability",
                # Funding
                "Handful of wealthy private donors", 
                "Government grants",
                # Gov Relations
                "Criticized by government",
                "Under government crackdown")

# Org Reactive Element
df <- reactive({
  #Amnesty International
    beta$ai_value <- 0
    beta$ai_value[beta$levels == 'Amnesty International'] <- 1
    beta$ai_value[beta$levels %in% input$ai_issue] <- 1
    beta$ai_value[beta$levels %in% input$ai_fin_trans] <- 1
    beta$ai_value[beta$levels %in% input$ai_account] <- 1
    beta$ai_value[beta$levels %in% input$ai_funding] <- 1
    beta$ai_value[beta$levels %in% input$ai_gov_relat] <- 1
  #Greenpeace
    beta$gp_value <- 0
    beta$gp_value[beta$levels == 'Greenpeace'] <- 1
    beta$gp_value[beta$levels %in% input$gp_issue] <- 1
    beta$gp_value[beta$levels %in% input$gp_fin_trans] <- 1
    beta$gp_value[beta$levels %in% input$gp_account] <- 1
    beta$gp_value[beta$levels %in% input$gp_funding] <- 1
    beta$gp_value[beta$levels %in% input$gp_gov_relat] <- 1
  #Oxfam
    beta$ox_value <- 0
    beta$ox_value[beta$levels == 'Oxfam'] <- 1
    beta$ox_value[beta$levels %in% input$ox_issue] <- 1
    beta$ox_value[beta$levels %in% input$ox_fin_trans] <- 1
    beta$ox_value[beta$levels %in% input$ox_account] <- 1
    beta$ox_value[beta$levels %in% input$ox_funding] <- 1
    beta$ox_value[beta$levels %in% input$ox_gov_relat] <- 1
  #Redcross
    beta$rc_value <- 0
    beta$rc_value[beta$levels == 'Red Cross'] <- 1
    beta$rc_value[beta$levels %in% input$rc_issue] <- 1
    beta$rc_value[beta$levels %in% input$rc_fin_trans] <- 1
    beta$rc_value[beta$levels %in% input$rc_account] <- 1
    beta$rc_value[beta$levels %in% input$rc_funding] <- 1
    beta$rc_value[beta$levels %in% input$rc_gov_relat] <- 1
    beta
    
})

################### Persona Reactive Element####################################

# Persona beta levels -----

beta_persona <- as.data.frame(matrix(rep(0), nrow = 111))

beta_persona$levels = c("Intercept",
                        # Follow National News
                        "Once a Week",
                        "At least once a day",
                        # Follow International News
                        "Sometimes",
                        "Always",
                        # News Mediums
                        "TV",
                        "Print",
                        "Online (not social media)",
                        "Social media",
                        "Radio",
                        "Email newsletter",
                        "News app",
                        # Follow Government or Public Affairs
                        "Often", 
                        # Travel to developing Countries
                        "Yes", 
                        # Political Preference
                        "Somewhat liberal",
                        "Slightly liberal",
                        "Moderate",
                        "Slightly conservative",
                        "Somewhat conservative",
                        "Extremely conservative",
                        # Trust in Political Institute
                        "Very little trust",
                        "Little trust",
                        "Nuetral",
                        "Some trust",
                        "A lot of trust",
                        "Complete trust",
                        # Should Others be Charitable
                        "Disagree",
                        "Somewhat disagree",
                        "Nuetral",
                        "Somewhat agree",
                        "Agree",
                        "Strongly agree",
                        # Worship Service Attendance
                        "Rarely",
                        "At least once a month",
                        # Religious Importance
                        "Important",
                        # Religion
                        "Protestant",
                        "Christian Orthodox",
                        "Jewish",
                        "Muslim",
                        "Sikh",
                        "Hindu",
                        "Buddhist",
                        "Atheist",
                        "Other (Religion)",
                        # Charity Trust Importance
                        "Very unimportant",
                        "Somewhat unimportant",
                        "Nuetral",
                        "Somewhat important",
                        "Very important",
                        "Essential",
                        # Trust in Charities
                        "Very little trust",
                        "Little trust",
                        "Nuetral",
                        "Some trust",
                        "A lot of trust",
                        "Complete trust",
                        # Donation Frequency
                        "At least once a month", 
                        # Donation Amount
                        "$50-$99",
                        "$100-$499",
                        "$500-$999",
                        "$1,000-$4,999",
                        "$5,000-$9,999",
                        "$10,000 +",
                        # Volunteered last 12 months
                        "Yes",
                        # Volunteer Frequency
                        "Rarely",
                        "More than once a month, less than once a year",
                        "At least once a month",
                        # Personal Activism
                        "Involved",
                        # Family Activism
                        "Involved",
                        # Religious Membership
                        "Inactive member",
                        "Active member",
                        # Sport or Recreational Membership
                        "Inactive member",
                        "Active member", 
                        # Art, Music, or Educational Membership
                        "Inactive member",
                        "Active member",
                        # Labor Union Membership
                        "Inactive member",
                        "Active member",
                        # Political Party Membership
                        "Inactive member",
                        "Active member",
                        # Environmental Organization Membership
                        "Inactive member",
                        "Active member",
                        # Professional Association
                        "Inactive member",
                        "Active member",
                        # Humanitarian or Charity Membership
                        "Inactive member",
                        "Active member",
                        # Consumer Organization Membership
                        "Inactive member",
                        "Active member",
                        #Other Organization Membership
                        "Inactive member",
                        "Active member",
                        # Gender
                        "Female",
                        "Transgender",
                        "Prefer not to say",
                        "Other (Gender)",
                        # Marital Status
                        "Widowed",
                        "Divorced",
                        "Separated",
                        "Never married",
                        # Education
                        "High school graduate", 
                        "Some college",
                        "2 year degree",
                        "4 year degree",
                        "Graduate or professional degree",
                        "Doctorate",
                        # Income
                        "More than median of $61,372", 
                        # Race
                        "White", 
                        "Black or African American", 
                        "American Indian or Alaska Native", 
                        "Asian", 
                        "Native Hawaiian or Pacific Islander", 
                        "Other (Race)", 
                        # Age
                        "More than median age of 36")


# p reactive element ----

p <- reactive({
  
  #Persona 1
    beta_persona$p1_value <- 0

    beta_persona$p1_value[beta_persona$levels == 'Persona 1'] <- 1
    
    beta_persona$p1_value[beta_persona$levels %in% input$p1_national_news] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_international_news] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_news_medium] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_follow_gov] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_travel_developing] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_political_pref] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_institution_trust] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_others_charitable] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_worship_attendence] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_religion_importance] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_religion] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_charity_importance] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_trust_in_charity] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_donation_frequency] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_donation_amount] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_volunteer_12] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_volunteer_frequency] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_personal_activism] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_family_activism] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_religious_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_sport_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_art_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_labor_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_political_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_environmental_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_professional_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_humanitarian_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_consumer_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_other_member] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_gender] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_marital_status] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_education] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_income] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_race] <- 1
    beta_persona$p1_value[beta_persona$levels %in% input$p1_age] <- 1
    
  #Persona 2
    beta_persona$p2_value <- 0

    beta_persona$p2_value[beta_persona$levels == 'Persona 2'] <- 1
    
    beta_persona$p2_value[beta_persona$levels %in% input$p2_national_news] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_international_news] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_news_medium] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_follow_gov] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_travel_developing] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_political_pref] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_institution_trust] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_others_charitable] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_worship_attendence] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_religion_importance] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_religion] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_charity_importance] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_trust_in_charity] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_donation_frequency] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_donation_amount] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_volunteer_12] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_volunteer_frequency] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_personal_activism] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_family_activism] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_religious_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_sport_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_art_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_labor_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_political_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_environmental_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_professional_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_humanitarian_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_consumer_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_other_member] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_gender] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_marital_status] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_education] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_income] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_race] <- 1
    beta_persona$p2_value[beta_persona$levels %in% input$p2_age] <- 1
    
  #Persona 3
    beta_persona$p3_value <- 0

    beta_persona$p3_value[beta_persona$levels == 'Persona 3'] <- 1

    beta_persona$p3_value[beta_persona$levels %in% input$p3_national_news] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_international_news] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_news_medium] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_follow_gov] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_travel_developing] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_political_pref] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_institution_trust] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_others_charitable] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_worship_attendence] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_religion_importance] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_religion] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_charity_importance] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_trust_in_charity] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_donation_frequency] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_donation_amount] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_volunteer_12] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_volunteer_frequency] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_personal_activism] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_family_activism] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_religious_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_sport_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_art_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_labor_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_political_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_environmental_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_professional_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_humanitarian_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_consumer_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_other_member] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_gender] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_marital_status] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_education] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_income] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_race] <- 1
    beta_persona$p3_value[beta_persona$levels %in% input$p3_age] <- 1
    beta_persona

})


```


```{r practice code}

#### this chunk is for testing code and making sure things work before adding it into the dashboard


# df <- as.data.frame(matrix(rep(0), nrow = 1))
# 
# df$levels = "Rating"
#                         
#                         
# df$p1[df$levels == "Rating"] <- input$rating_id
# 
# 
# p1_pol_pref <- reactive({
#   input$p1_political_pref
# })
# 
# 
# sliderInput("rating_id",
#        label = "Rating",
#        min = 0,
#        max = 7,
#        value = 0)



# beta_persona_test <- as.data.frame(matrix(rep(0), nrow = 38))
# 
# beta_persona_test$levels = c("Persona 1", "Persona 2", "Persona 3", "Chartiy Importance", "Trust in Charity", "Donation Frequency", "Donation Amount", "Volunteer 12 Months", "Volunteer Frequence","Personal Activism", "Family Activism", "Religious Membership", "Sport or Recreational Membership", "Art, Music, or Educational Membership","Labor Union Membership", "Political Party Membership", "Environmental Organization Membership", "Professional Association", "Humanitarian or Charity Membership","Consumer Organization Membership", "Other Organization Membership", "Follow National News", "Follow International News", "News Medium","Follow Government or Public Affairs", "Travel to Developing Countries", "Political Preference", "Trust in Political Institutions", "Others Should be Charitable", "Worship Service Attendence", "Religious Importance", "Religion", "Gender", "Marital Status", "Education", "Income", "Race", "Age")
# 
# 
# 
# # Persona Reactive Element
# 
# beta_persona_test$p1 <- 1
# 
# beta_persona_test$p2 <- 2
# 
# beta_persona_test$p3 <- 3
#         
# persona1 <- persona_data[,2]
# 
# p_beta1 <- as.matrix(public_political_social_charity_demo) %*%   
#   
#   as.matrix(persona1) %*% beta_persona_test[,3]


  


```

```{r matrix multiplication, eval=FALSE, include=FALSE}
library(shiny)

beta <- data.frame(
  value = c(0,0,0),
  levels = c("Environment", "Human rights", "Refugee relief")
)

ui <- fluidPage(
  fluidRow(
    column(6,
      selectInput("ai_issue", 
                  label = "Select Issue Area:",
                  choices = beta$levels,
                  multiple = TRUE)
    ),
    column(6,
      tableOutput("data")
    )
  )
)

server = function(input, output) {

  df <- reactive({
    beta$value[beta$levels %in% input$ai_issue] <- 1
    beta
  })

  output$data <- renderTable({
    df()
  })
}
```

<!-- Persona Inputs  -->
<!-- ================================================= -->

<!-- ## Persona Inputs -->



```{r persona betas}

### Calculating the Persona betas ###

# Persona 1
persona1 <- persona_data[,2]

p_beta1 <- as.matrix(public_political_social_charity_demo) %*% as.matrix(persona1)


# Persona 2
persona2 <- persona_data[,3]

p_beta2 <- as.matrix(public_political_social_charity_demo) %*% as.matrix(persona2)


# 
# exp_util2 <- round(exp(t(beta_test[, 4]) %*% as.matrix(p_beta2)),2)


# Persona 3
persona3 <- persona_data[,4]

p_beta3 <- as.matrix(public_political_social_charity_demo) %*% as.matrix(persona3)

# 
# exp_util3 <- round(exp(t(beta_test[, 5]) %*% as.matrix(p_beta3)),2)

```

<!-- Main page Chart with All Personas -->

Market Share
--------------------------------------

```{r plot all personas}

renderPlotly({
  org_choice = df()
  per_choice = p()
    
  # Persona 1 
    p_beta1 <- as.matrix(public_political_social_charity_demo) %*% as.matrix(per_choice[,3])
  
  # Expected Utility
  ai_exp_util1 <- round(exp(t(org_choice[, 3]) %*% as.matrix(p_beta1)),2)
  gp_exp_util1 <- round(exp(t(org_choice[, 4]) %*% as.matrix(p_beta1)),2)
  ox_exp_util1 <- round(exp(t(org_choice[, 5]) %*% as.matrix(p_beta1)),2)
  rc_exp_util1 <- round(exp(t(org_choice[, 6]) %*% as.matrix(p_beta1)),2)
  
  # Market Share
  ai_rate1 <- round(100 * ai_exp_util1/sum(ai_exp_util1, gp_exp_util1, ox_exp_util1, rc_exp_util1))
  gp_rate1 <- round(100 * gp_exp_util1/sum(ai_exp_util1, gp_exp_util1, ox_exp_util1, rc_exp_util1))
  ox_rate1 <- round(100 * ox_exp_util1/sum(ai_exp_util1, gp_exp_util1, ox_exp_util1, rc_exp_util1))
  rc_rate1 <- round(100 * rc_exp_util1/sum(ai_exp_util1, gp_exp_util1, ox_exp_util1, rc_exp_util1))
  
  # Persona 2
    p_beta2 <- as.matrix(public_political_social_charity_demo) %*% as.matrix(per_choice[,4])
  
  # Expected Utility
  ai_exp_util2 <- round(exp(t(org_choice[, 3]) %*% as.matrix(p_beta2)),2)
  gp_exp_util2 <- round(exp(t(org_choice[, 4]) %*% as.matrix(p_beta2)),2)
  ox_exp_util2 <- round(exp(t(org_choice[, 5]) %*% as.matrix(p_beta2)),2)
  rc_exp_util2 <- round(exp(t(org_choice[, 6]) %*% as.matrix(p_beta2)),2)
  
  # Market Share
  ai_rate2 <- round(100 * ai_exp_util2/sum(ai_exp_util2, gp_exp_util2, ox_exp_util2, rc_exp_util2))
  gp_rate2 <- round(100 * gp_exp_util2/sum(ai_exp_util2, gp_exp_util2, ox_exp_util2, rc_exp_util2))
  ox_rate2 <- round(100 * ox_exp_util2/sum(ai_exp_util2, gp_exp_util2, ox_exp_util2, rc_exp_util2))
  rc_rate2 <- round(100 * rc_exp_util2/sum(ai_exp_util2, gp_exp_util2, ox_exp_util2, rc_exp_util2))
  
  # Persona 3
    p_beta3 <- as.matrix(public_political_social_charity_demo) %*% as.matrix(per_choice[,5])
  
  # Expected Utility
  ai_exp_util3 <- round(exp(t(org_choice[, 3]) %*% as.matrix(p_beta3)),2)
  gp_exp_util3 <- round(exp(t(org_choice[, 4]) %*% as.matrix(p_beta3)),2)
  ox_exp_util3 <- round(exp(t(org_choice[, 5]) %*% as.matrix(p_beta3)),2)
  rc_exp_util3 <- round(exp(t(org_choice[, 6]) %*% as.matrix(p_beta3)),2)
  
  # Market Share
  ai_rate3 <- round(100 * ai_exp_util3/sum(ai_exp_util3, gp_exp_util3, ox_exp_util3, rc_exp_util3))
  gp_rate3 <- round(100 * gp_exp_util3/sum(ai_exp_util3, gp_exp_util3, ox_exp_util3, rc_exp_util3))
  ox_rate3 <- round(100 * ox_exp_util3/sum(ai_exp_util3, gp_exp_util3, ox_exp_util3, rc_exp_util3))
  rc_rate3 <- round(100 * rc_exp_util3/sum(ai_exp_util3, gp_exp_util3, ox_exp_util3, rc_exp_util3))
  
  # Data for Plotly
  data <- c(ai_exp_util1, gp_exp_util1, ox_exp_util1, rc_exp_util1, ai_rate1, gp_rate1, ox_rate1, rc_rate1, 
            ai_exp_util2, gp_exp_util2, ox_exp_util2, rc_exp_util2, ai_rate2, gp_rate2, ox_rate2, rc_rate2,
            ai_exp_util3, gp_exp_util3, ox_exp_util3, rc_exp_util3, ai_rate3, gp_rate3, ox_rate3, rc_rate3)
  
  
  # Empty dataframe
  df <- as.data.frame(matrix(data, 24, 1))
  
  # Organization name inputs
  df[,2] <- c(input$ai_id, input$gp_id, input$ox_id, input$rc_id)
  # Type of value
  df[,3] <- c(rep("Utility", 4), rep("Market Share", 4))
  # Persona name inputs
  df[,4] <- c(rep(input$p1_id,8), rep(input$p2_id, 8), rep(input$p3_id, 8))
 
  # Rename columns
  colnames(df) <- c('Value', 'Organization', "Type", "Persona")
  
  
  ggplotly(df %>% 
             # Only care about the Market Share right now
             filter(Type == "Market Share") %>% 
             # Factor Organization and Persona with ordered=TRUE so the order doesn't change to alphabetical as names are created
             mutate(
               Organization = factor(Organization, levels = c(input$ai_id, input$gp_id, input$ox_id, input$rc_id), ordered = TRUE),
               Persona = factor(Persona, levels = c(input$p1_id, input$p2_id, input$p3_id), ordered = TRUE)) %>% 
             ggplot(aes(y = Value, x = Organization, fill = Persona)) +
             geom_bar(position = "dodge", stat = "identity") +
             labs(x="", y = "Market Share") + 
             scale_fill_manual(values = c( "#FFC30B", "#28a153", "#c23838")) +
             theme(legend.position = "right",
                   panel.background = element_blank(),
                   panel.grid.major.y = element_line(color = "#D3D3D3"))
    )
})

```

<!-- Organizational Tabs -->

Personas And Organizations {.tabset .tabset-fade}
--------------------------------------------------


### Persona 1

```{r persona 1 inputs}

textInput("p1_id",
          label = "Persona Name",
          value = "Persona 1",
          placeholder = "Enter Persona Name")

selectInput("p1_national_news",
         label = "Follow national news:",
         choices = c("Rarely",
                     "Once a week",
                     "At least once a day"))

selectInput("p1_international_news",
         label = "Follow international news:",
         choices = c("Never",
                     "Sometimes",
                     'Always'))

selectInput("p1_news_medium",
         label = "Medium to follow news:",
         choices = c('TV',
                     'Print',
                     "Online (not social media)",
                     "Social media",
                     "Radio",
                     "Email newsletter",
                     "News app"),
         multiple = TRUE)

selectInput("p1_follow_gov",
         label = "Follow government & public affairs:",
         choices = c("Not Often",
                     "Often"))

selectInput("p1_travel_developing",
         label = "Travel to developing country:",
         choices = c('No', "Yes"))

selectInput("p1_political_pref",
         label = "Political views from liberal to conservative:",
         choices = c("Extremely liberal",
                     "Somewhat liberal",
                     "Slightly liberal",
                     "Moderate",
                     "Slightly conservative",
                     "Somewhat conservative",
                     "Extremely conservative"))

selectInput("p1_institution_trust",
         label = "Political institution trust from none to complete:",
         choices = c("No trust at all",
                     "Very little trust",
                     "Little trust",
                     "Nuetral",
                     "Some trust",
                     "A lot of trust",
                     "Complete trust"))

selectInput("p1_others_charitable",
         label = "People should be more charitable:",
         choices = c("Strongly Disagree",
                     "Disagree",
                     "Somewhat disagree",
                     "Nuetral",
                     "Somewhat agree",
                     "Agree",
                     "Strongly Agree"))

selectInput("p1_worship_attendance",
         label = "Worship service attendance:",
         choices = c("Not sure",
                     "Rarely",
                     "At least once a month"))

selectInput("p1_religion_importance",
         label = "Importance of religion:",
         choices = c("Not important",
                     "Important"))

selectInput("p1_religion",
         label = "Religion:",
         choices = c('Catholic',
                     'Protestant',
                     'Christian Orthodox',
                     'Jewish',
                     'Muslim',
                     'Sikh',
                     'Hindu',
                     'Buddhist',
                     'Atheist',
                     'Other (Religion)'))

selectInput("p1_charity_importance",
          label = "Charity Importance:",
          choices = c("Not at all important",
                      "Very unimportant",
                      "Somewhat unimportant",
                      "Nuetral",
                      "Somewhat important",
                      "Very important",
                      "Essential"))

selectInput("p1_trust_in_charity",
            label = "Charity Trust:",
            choices = c("No trust at all",
                        "Very little trust",
                        "Little trust",
                        "Nuetral",
                        "Some trust",
                        "A lot of trust",
                        "Complete trust"))

selectInput("p1_donation_frequency",
         label = "Donation Frequency:",
         choices = c('More than once a month, less than once a year',
                     'Atleast once a month'))

selectInput("p1_donation_amount",
         label = "Donation Amount:",
         choices = c("$1-$49",
                     '$50-$99',
                     '$100-$499',
                     '$500-$999',
                     '$1,000-$4,999',
                     '$5,000-$9,999',
                     '$10,000+'))

selectInput("p1_volunteer_12",
         label = "Volunteered in last 12 Months:",
         choices = c("No", "Yes"))

selectInput("p1_volunteer_frequency",
         label = "Volunteer Frequency:",
         choices = c("Haven't volunteered in past 12 months",
                     "Rarely",
                     "More than once a month, less than once a year",
                     "At least once a month"))

selectInput("p1_personal_activism",
         label = "Personal Activism:",
         choices = c('Not involved',
                     'Involved'))

selectInput("p1_family_activism",
         label = "Family Activism:",
         choices = c('Not involved',
                     'Involved'))

selectInput("p1_religious_member",
         label = "Church Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_sport_member",
         label = "Sport or Recreational Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_art_member",
         label = "Art, Music, or Educational Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_labor_member",
         label = "Labor Union Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_political_member",
         label = "Political Party Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_environmental_member",
         label = "Enviornmental Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_professional_member",
         label = "Professional Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_humanitarian_member",
         label = "Humanitarian Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_consumer_member",
         label = "Consumer Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_other_member",
         label = "Other Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p1_gender",
         label = "Gender:",
         choices = c("Male",
                     "Female",
                     "Transgender",
                     "Prefer not to say",
                     "Other (Gender)"))

selectInput("p1_marital_status",
         label = "Marital Status:",
         choices = c("Married",
                     "Widowed",
                     "Divorced",
                     "Separated",
                     "Never married"))

selectInput("p1_education",
         label = "Education:",
         choices = c("Less than high school",
                     "High school graduate",
                     "Some college",
                     "2 year degree",
                     "4 year degree",
                     "Graduate or professional degree",
                     "Doctorate"))

selectInput("p1_income",
         label = "Income:",
         choices = c('Less than median of $61,372',
                     'More than median of $61,372'))

selectInput("p1_race",
         label = "Race(s):",
         choices = c('White',
                     'Black or African American',
                     'American Indian or Alaska Native',
                     'Asian',
                     'Native Hawaiian or Pacific Islander',
                     'Other (Race)'),
         multiple = TRUE)

selectInput("p1_age",
         label = "Age:",
         choices = c('Less than median age of 36',
                     "More than median age of 36"))

```


### Persona 2

```{r persona 2 inputs}

textInput("p2_id",
          label = "Persona Name",
          value = "Persona 2",
          placeholder = "Enter Persona Name")

selectInput("p2_national_news",
         label = "Follow national news:",
         choices = c("Rarely",
                     "Once a week",
                     "At least once a day"))

selectInput("p2_international_news",
         label = "Follow international news:",
         choices = c("Never",
                     "Sometimes",
                     'Always'))

selectInput("p2_news_medium",
         label = "Medium to follow news:",
         choices = c('TV',
                     'Print',
                     "Online (not social media)",
                     "Social media",
                     "Radio",
                     "Email newsletter",
                     "News app"),
         multiple = TRUE)

selectInput("p2_follow_gov",
         label = "Follow government & public affairs:",
         choices = c("Not Often",
                     "Often"))

selectInput("p2_travel_developing",
         label = "Travel to developing country:",
         choices = c('No', "Yes"))

selectInput("p2_political_pref",
         label = "Political views from liberal to conservative:",
         choices = c("Extremely liberal",
                     "Somewhat liberal",
                     "Slightly liberal",
                     "Moderate",
                     "Slightly conservative",
                     "Somewhat conservative",
                     "Extremely conservative"))

selectInput("p2_institution_trust",
         label = "Political institution trust from none to complete:",
         choices = c("No trust at all",
                     "Very little trust",
                     "Little trust",
                     "Nuetral",
                     "Some trust",
                     "A lot of trust",
                     "Complete trust"))

selectInput("p2_others_charitable",
         label = "People should be more charitable:",
         choices = c("Strongly Disagree",
                     "Disagree",
                     "Somewhat disagree",
                     "Nuetral",
                     "Somewhat agree",
                     "Agree",
                     "Strongly Agree"))

selectInput("p2_worship_attendance",
         label = "Worship service attendance:",
         choices = c("Not sure",
                     "Rarely",
                     "At least once a month"))

selectInput("p2_religion_importance",
         label = "Importance of religion:",
         choices = c("Not important",
                     "Important"))

selectInput("p2_religion",
         label = "Religion:",
         choices = c('Catholic',
                     'Protestant',
                     'Christian Orthodox',
                     'Jewish',
                     'Muslim',
                     'Sikh',
                     'Hindu',
                     'Buddhist',
                     'Atheist',
                     'Other (Religion)'))

selectInput("p2_charity_importance",
          label = "Charity Importance:",
          choices = c("Not at all important",
                      "Very unimportant",
                      "Somewhat unimportant",
                      "Nuetral",
                      "Somewhat important",
                      "Very important",
                      "Essential"))

selectInput("p2_trust_in_charity",
            label = "Charity Trust:",
            choices = c("No trust at all",
                        "Very little trust",
                        "Little trust",
                        "Nuetral",
                        "Some trust",
                        "A lot of trust",
                        "Complete trust"))

selectInput("p2_donation_frequency",
         label = "Donation Frequency:",
         choices = c('More than once a month, less than once a year',
                     'Atleast once a month'))

selectInput("p2_donation_amount",
         label = "Donation Amount:",
         choices = c("$1-$49",
                     '$50-$99',
                     '$100-$499',
                     '$500-$999',
                     '$1,000-$4,999',
                     '$5,000-$9,999',
                     '$10,000+'))

selectInput("p2_volunteer_12",
         label = "Volunteered in last 12 Months:",
         choices = c("No", "Yes"))

selectInput("p2_volunteer_frequency",
         label = "Volunteer Frequency:",
         choices = c("Haven't volunteered in past 12 months",
                     "Rarely",
                     "More than once a month, less than once a year",
                     "At least once a month"))

selectInput("p2_personal_activism",
         label = "Personal Activism:",
         choices = c('Not involved',
                     'Involved'))

selectInput("p2_family_activism",
         label = "Family Activism:",
         choices = c('Not involved',
                     'Involved'))

selectInput("p2_religious_member",
         label = "Church Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_sport_member",
         label = "Sport or Recreational Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_art_member",
         label = "Art, Music, or Educational Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_labor_member",
         label = "Labor Union Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_political_member",
         label = "Political Party Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_environmental_member",
         label = "Enviornmental Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_professional_member",
         label = "Professional Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_humanitarian_member",
         label = "Humanitarian Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_consumer_member",
         label = "Consumer Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_other_member",
         label = "Other Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p2_gender",
         label = "Gender:",
         choices = c("Male",
                     "Female",
                     "Transgender",
                     "Prefer not to say",
                     "Other (Gender)"))

selectInput("p2_marital_status",
         label = "Marital Status:",
         choices = c("Married",
                     "Widowed",
                     "Divorced",
                     "Separated",
                     "Never married"))

selectInput("p2_education",
         label = "Education:",
         choices = c("Less than high school",
                     "High school graduate",
                     "Some college",
                     "2 year degree",
                     "4 year degree",
                     "Graduate or professional degree",
                     "Doctorate"))

selectInput("p2_income",
         label = "Income:",
         choices = c('Less than median of $61,372',
                     'More than median of $61,372'))

selectInput("p2_race",
         label = "Race(s):",
         choices = c('White',
                     'Black or African American',
                     'American Indian or Alaska Native',
                     'Asian',
                     'Native Hawaiian or Pacific Islander',
                     'Other (Race)'),
         multiple = TRUE)

selectInput("p2_age",
         label = "Age:",
         choices = c('Less than median age of 36',
                     "More than median age of 36"))

```


### Persona 3

```{r persona 3 inputs}

textInput("p3_id",
          label = "Persona Name",
          value = "Persona 3",
          placeholder = "Enter Persona Name")

selectInput("p3_national_news",
         label = "Follow national news:",
         choices = c("Rarely",
                     "Once a week",
                     "At least once a day"))

selectInput("p3_international_news",
         label = "Follow international news:",
         choices = c("Never",
                     "Sometimes",
                     'Always'))

selectInput("p3_news_medium",
         label = "Medium to follow news:",
         choices = c('TV',
                     'Print',
                     "Online (not social media)",
                     "Social media",
                     "Radio",
                     "Email newsletter",
                     "News app"),
         multiple = TRUE)

selectInput("p3_follow_gov",
         label = "Follow government & public affairs:",
         choices = c("Not Often",
                     "Often"))

selectInput("p3_travel_developing",
         label = "Travel to developing country:",
         choices = c('No', "Yes"))

selectInput("p3_political_pref",
         label = "Political views from liberal to conservative:",
         choices = c("Extremely liberal",
                     "Somewhat liberal",
                     "Slightly liberal",
                     "Moderate",
                     "Slightly conservative",
                     "Somewhat conservative",
                     "Extremely conservative"))

selectInput("p3_institution_trust",
         label = "Political institution trust from none to complete:",
         choices = c("No trust at all",
                     "Very little trust",
                     "Little trust",
                     "Nuetral",
                     "Some trust",
                     "A lot of trust",
                     "Complete trust"))

selectInput("p3_others_charitable",
         label = "People should be more charitable:",
         choices = c("Strongly Disagree",
                     "Disagree",
                     "Somewhat disagree",
                     "Nuetral",
                     "Somewhat agree",
                     "Agree",
                     "Strongly Agree"))

selectInput("p3_worship_attendance",
         label = "Worship service attendance:",
         choices = c("Not sure",
                     "Rarely",
                     "At least once a month"))

selectInput("p3_religion_importance",
         label = "Importance of religion:",
         choices = c("Not important",
                     "Important"))

selectInput("p3_religion",
         label = "Religion:",
         choices = c('Catholic',
                     'Protestant',
                     'Christian Orthodox',
                     'Jewish',
                     'Muslim',
                     'Sikh',
                     'Hindu',
                     'Buddhist',
                     'Atheist',
                     'Other (Religion)'))

selectInput("p3_charity_importance",
          label = "Charity Importance:",
          choices = c("Not at all important",
                      "Very unimportant",
                      "Somewhat unimportant",
                      "Nuetral",
                      "Somewhat important",
                      "Very important",
                      "Essential"))

selectInput("p3_trust_in_charity",
            label = "Charity Trust:",
            choices = c("No trust at all",
                        "Very little trust",
                        "Little trust",
                        "Nuetral",
                        "Some trust",
                        "A lot of trust",
                        "Complete trust"))

selectInput("p3_donation_frequency",
         label = "Donation Frequency:",
         choices = c('More than once a month, less than once a year',
                     'Atleast once a month'))

selectInput("p3_donation_amount",
         label = "Donation Amount:",
         choices = c("$1-$49",
                     '$50-$99',
                     '$100-$499',
                     '$500-$999',
                     '$1,000-$4,999',
                     '$5,000-$9,999',
                     '$10,000+'))

selectInput("p3_volunteer_12",
         label = "Volunteered in last 12 Months:",
         choices = c("No", "Yes"))

selectInput("p3_volunteer_frequency",
         label = "Volunteer Frequency:",
         choices = c("Haven't volunteered in past 12 months",
                     "Rarely",
                     "More than once a month, less than once a year",
                     "At least once a month"))

selectInput("p3_personal_activism",
         label = "Personal Activism:",
         choices = c('Not involved',
                     'Involved'))

selectInput("p3_family_activism",
         label = "Family Activism:",
         choices = c('Not involved',
                     'Involved'))

selectInput("p3_religious_member",
         label = "Church Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_sport_member",
         label = "Sport or Recreational Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_art_member",
         label = "Art, Music, or Educational Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_labor_member",
         label = "Labor Union Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_political_member",
         label = "Political Party Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_environmental_member",
         label = "Enviornmental Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_professional_member",
         label = "Professional Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_humanitarian_member",
         label = "Humanitarian Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_consumer_member",
         label = "Consumer Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_other_member",
         label = "Other Org. Membership:",
         choices = c("Don't belong",
                     'Inactive member',
                     'Active member'))

selectInput("p3_gender",
         label = "Gender:",
         choices = c("Male",
                     "Female",
                     "Transgender",
                     "Prefer not to say",
                     "Other (Gender)"))

selectInput("p3_marital_status",
         label = "Marital Status:",
         choices = c("Married",
                     "Widowed",
                     "Divorced",
                     "Separated",
                     "Never married"))

selectInput("p3_education",
         label = "Education:",
         choices = c("Less than high school",
                     "High school graduate",
                     "Some college",
                     "2 year degree",
                     "4 year degree",
                     "Graduate or professional degree",
                     "Doctorate"))

selectInput("p3_income",
         label = "Income:",
         choices = c('Less than median of $61,372',
                     'More than median of $61,372'))

selectInput("p3_race",
         label = "Race(s):",
         choices = c('White',
                     'Black or African American',
                     'American Indian or Alaska Native',
                     'Asian',
                     'Native Hawaiian or Pacific Islander',
                     'Other (Race)'),
         multiple = TRUE)

selectInput("p3_age",
         label = "Age:",
         choices = c('Less than median age of 36',
                     "More than median age of 36"))

```


### Org 1

```{r ai org inputs}

textInput("ai_id",
          label = "Organization Name",
          value = "Organization 1",
          placeholder = "Enter Organiation Name")

selectInput("ai_issue", 
            label = "Select Issue Area:",
            choices = c("Emergency response",
                        "Environment",
                        "Human rights",
                        "Refugee relief"))

selectInput("ai_fin_trans",
            label = "Select Financial Transparency:",
            choices = c("Doesnt engage in transparency",
                        "Engages in transparency"))

selectInput("ai_account",
            label = "Select Financial Accountability:",
            choices = c("Doesnt engage in financial accountability",
                        "Engages in financial accountability"))

selectInput("ai_funding",
            label = "Select Funding Source:",
            choices = c("Many small private donations",
                        "Handful of wealthy private donors",
                        "Government grants"))

selectInput("ai_gov_relat",
            label = "Select Relationship With Host Government",
            choices = c("Friendly relationship with government",
                        "Criticized by government", 
                        "Under government crackdown"))


```

### Org 2

```{r gp org inputs}


textInput("gp_id",
          label = "Organization Name",
          value = "Organization 2",
          placeholder = "Enter Organiation Name"
)

selectInput("gp_issue", 
            label = "Select Issue Area:",
            choices = c("Emergency response",
                        "Environment",
                        "Human rights",
                        "Refugee relief"))

selectInput("gp_fin_trans",
            label = "Select Financial Transparency:",
            choices = c("Doesnt engage in transparency",
                        "Engages in transparency"))

selectInput("gp_account",
            label = "Select Financial Accountability:",
            choices = c("Doesnt engage in financial accountability",
                        "Engages in financial accountability"))

selectInput("gp_funding",
            label = "Select Funding Source:",
            choices = c("Many small private donations",
                        "Handful of wealthy private donors",
                        "Government grants"))

selectInput("gp_gov_relat",
            label = "Select Relationship With Host Government",
            choices = c("Friendly relationship with government",
                        "Criticized by government", 
                        "Under government crackdown"))
```

### Org 3

```{r ox org inputs}

textInput("ox_id",
          label = "Organization Name",
          value = "Organization 3",
          placeholder = "Enter Organiation Name"
)


selectInput("ox_issue", 
            label = "Select Issue Area:",
            choices = c("Emergency response",
                        "Environment",
                        "Human rights",
                        "Refugee relief"))

selectInput("ox_fin_trans",
            label = "Select Financial Transparency:",
            choices = c("Doesnt engage in transparency",
                        "Engages in transparency"))

selectInput("ox_account",
            label = "Select Financial Accountability:",
            choices = c("Doesnt engage in financial accountability",
                        "Engages in financial accountability"))

selectInput("ox_funding",
            label = "Select Funding Source:",
            choices = c("Many small private donations",
                        "Handful of wealthy private donors",
                        "Government grants"))

selectInput("ox_gov_relat",
            label = "Select Relationship With Host Government",
            choices = c("Friendly relationship with government",
                        "Criticized by government", 
                        "Under government crackdown"))
```

### Org 4

```{r rc org inputs}

textInput("rc_id",
          label = "Organization Name",
          value = "Organization 4",
          placeholder = "Enter Organiation Name"
)


selectInput("rc_issue", 
            label = "Select Issue Area:",
            choices = c("Emergency response",
                        "Environment",
                        "Human rights",
                        "Refugee relief"))

selectInput("rc_fin_trans",
            label = "Select Financial Transparency:",
            choices = c("Doesnt engage in transparency",
                        "Engages in transparency"))

selectInput("rc_account",
            label = "Select Financial Accountability:",
            choices = c("Doesnt engage in financial accountability",
                        "Engages in financial accountability"))

selectInput("rc_funding",
            label = "Select Funding Source:",
            choices = c("Many small private donations",
                        "Handful of wealthy private donors",
                        "Government grants"))

selectInput("rc_gov_relat",
            label = "Select Relationship With Host Government",
            choices = c("Friendly relationship with government",
                        "Criticized by government", 
                        "Under government crackdown"))
```













